{
  "hash": "9cd808fe5b6959167d86691d8e439983",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take Home Exercise 02\"\nauthor: \"Henry Low\"\ndate: \"Sep 25 2024\"\ndate-modified: \"last-modified\"\nexecute:\n  evalu: true\n  context: shared\n  echo: true\n  message: false\n  freeze: true\nformat: html\neditor: visual\ndate-format: \"DD MM YYYY\"\n---\n\n\n\n# Background\n\nTourism has been a key driver of Thailand's gross domestic product (GDP), accounting for up to 20% of it. The COVID-19 pandemic caused the tourism revenue (from domestic and international tourism) to crash to US\\$24 billion in 2020, from US\\$90 billion in 2019.\n\n# Objectives\n\nUsing appropriate global and local spatial autocorrelation analysis and emerging hotspot analysis, I would like to find out:\\\n- If the key indicators of tourism economy of Thailand are independent from space and space and time.\\\n- If the tourism economy is indeed spatial and spatio-temporal dependent.\\\n- If so, detect where the clusters and outliers are, and the emerging hotpot and cold spot areas.\n\n# Study Area\n\nThe study area will be Thailand (sf_polygon features) at [province](https://en.wikipedia.org/wiki/Provinces_of_Thailand) level.\n\n# Data Sources\n\n*(saved under 'data' folder)*\\\n[Thailand Domestic Tourism Statistics 2019-2023](https://www.kaggle.com/datasets/thaweewatboy/thailand-domestic-tourism-statistics) from Kaggle\\\n[Thailand - Subnational Administrative Boundaries from HDX](https://data.humdata.org/dataset/cod-ab-tha?)...[Click here to download here](https://data.humdata.org/dataset/d24bdc45-eb4c-4e3d-8b16-44db02667c27/resource/d0c722ff-6939-4423-ac0d-6501830b1759/download/tha_adm_rtsd_itos_20210121_shp.zip)\n\n# 1 Setting Up\n\n## 1.1 Loading R Packages\n\nI will be using the following R packages:\\\n-`sf` package to perform geospatial wrangling tasks \\\n- `sfdep` package to perform spatial autocorrelation analysis and emerging hotspot analysis \\\n- `tidyverse` package for reading csv files, dataframe processing tasks \\\n- `ggplot2` and `ggpubr` package for plotting statistical graphics \\\n- `tmap` package for plotting tasks \\\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tidyverse, sfdep, sf, ggplot2, ggpubr, tmap, DT, crosstalk)\n```\n:::\n\n\n\n## 1.2 Loading Datasets\n\nThe aim here is to load the datasets and do the necessary geospatial data wrangling before proceeding to the subsequent steps.\n\n### 1.2.1 Thailand Subnational Adminstrative Boundaries\n\n`st_read` from the sf package is used to load the subnational boundaries.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load Thailand Province from HDX\nth_bound_l1 <- st_read(dsn = \"data/tha_adm_rtsd_itos_20210121_shp/\", layer = \"tha_admbnda_adm1_rtsd_20220121\") %>%\n  st_transform(crs = 32647) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `tha_admbnda_adm1_rtsd_20220121' from data source \n  `C:\\Users\\Henry\\Desktop\\SMU Masters\\2024-2025 T1\\Geospatial Analytics & Applications\\Project\\GeospatialWebsite\\Take-Home_Ex\\Take-Home_Ex_02\\data\\tha_adm_rtsd_itos_20210121_shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 77 features and 16 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 97.34336 ymin: 5.613038 xmax: 105.637 ymax: 20.46507\nGeodetic CRS:  WGS 84\n```\n\n\n:::\n\n```{.r .cell-code}\n# Check output\nglimpse(th_bound_l1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 77\nColumns: 17\n$ Shape_Leng <dbl> 2.417227, 1.695100, 1.251111, 1.884945, 3.041716, 1.739908,…\n$ Shape_Area <dbl> 0.13133873, 0.07926199, 0.05323766, 0.12698345, 0.21393797,…\n$ ADM1_EN    <chr> \"Bangkok\", \"Samut Prakan\", \"Nonthaburi\", \"Pathum Thani\", \"P…\n$ ADM1_TH    <chr> \"กรุงเทพมหานคร\", \"สมุทรปราการ\", \"นนทบุรี\", \"ปทุมธานี\", \"พระนครศรีอ…\n$ ADM1_PCODE <chr> \"TH10\", \"TH11\", \"TH12\", \"TH13\", \"TH14\", \"TH15\", \"TH16\", \"TH…\n$ ADM1_REF   <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ ADM1ALT1EN <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ ADM1ALT2EN <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ ADM1ALT1TH <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ ADM1ALT2TH <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ ADM0_EN    <chr> \"Thailand\", \"Thailand\", \"Thailand\", \"Thailand\", \"Thailand\",…\n$ ADM0_TH    <chr> \"ประเทศไทย\", \"ประเทศไทย\", \"ประเทศไทย\", \"ประเทศไทย\", \"ประเทศ…\n$ ADM0_PCODE <chr> \"TH\", \"TH\", \"TH\", \"TH\", \"TH\", \"TH\", \"TH\", \"TH\", \"TH\", \"TH\",…\n$ date       <date> 2019-02-18, 2019-02-18, 2019-02-18, 2019-02-18, 2019-02-18…\n$ validOn    <date> 2022-01-22, 2022-01-22, 2022-01-22, 2022-01-22, 2022-01-22…\n$ validTo    <date> -001-11-30, -001-11-30, -001-11-30, -001-11-30, -001-11-30…\n$ geometry   <MULTIPOLYGON [m]> MULTIPOLYGON (((674339.8 15..., MULTIPOLYGON (…\n```\n\n\n:::\n:::\n\n\n\n### 1.2.2 Thailand Tourism Data\n\n`read_csv` from readr package within tidyverse is used to load the aspatial data as a tibble.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntbl_tourism <- read_csv('data/archive/thailand_domestic_tourism_2019_2023_ver2.csv')\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 30800 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (5): province_thai, province_eng, region_thai, region_eng, variable\ndbl  (1): value\ndate (1): date\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\nglimpse(tbl_tourism)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 30,800\nColumns: 7\n$ date          <date> 2019-01-01, 2019-01-01, 2019-01-01, 2019-01-01, 2019-01…\n$ province_thai <chr> \"กรุงเทพมหานคร\", \"ลพบุรี\", \"พระนครศรีอยุธยา\", \"สระบุรี\", \"ชัยนาท…\n$ province_eng  <chr> \"Bangkok\", \"Lopburi\", \"Phra Nakhon Si Ayutthaya\", \"Sarab…\n$ region_thai   <chr> \"ภาคกลาง\", \"ภาคกลาง\", \"ภาคกลาง\", \"ภาคกลาง\", \"ภาคกลาง\", \"…\n$ region_eng    <chr> \"central\", \"central\", \"central\", \"central\", \"central\", \"…\n$ variable      <chr> \"ratio_tourist_stay\", \"ratio_tourist_stay\", \"ratio_touri…\n$ value         <dbl> 93.37, 61.32, 73.37, 67.33, 79.31, 71.70, 64.65, 71.21, …\n```\n\n\n:::\n:::\n\n\n\nBefore joining the 2 datasets, we need to check if there are any non-matching values in either joining columns.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Find values in Th bound that are not in Tourism Data\nonly_in_th_bound_l1 <- anti_join(th_bound_l1, tbl_tourism, by = c(\"ADM1_EN\" = \"province_eng\")) %>% pull(ADM1_EN)\n\n# Find values in Tourism Data that are not in Th Bound\nonly_in_tbl_tourism <- anti_join(tbl_tourism, th_bound_l1, by = c(\"province_eng\" = \"ADM1_EN\")) %>% pull(province_eng)\n\n# See all values\nunmatched_values <- union(only_in_th_bound_l1, only_in_tbl_tourism)\nprint(unmatched_values)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"Lop Buri\"         \"Chai Nat\"         \"Chon Buri\"        \"Prachin Buri\"    \n [5] \"Buri Ram\"         \"Si Sa Ket\"        \"Nong Bua Lam Phu\" \"Phangnga\"        \n [9] \"Lopburi\"          \"Chainat\"          \"Chonburi\"         \"Prachinburi\"     \n[13] \"Phang Nga\"        \"Buriram\"          \"Sisaket\"          \"Nong Bua Lamphu\" \n```\n\n\n:::\n:::\n\n\n\nSince we found the discrepancies, minor re-coding is required to ensure that values are aligned. The KPIs are also pivoted from long to wide to facilitate future analysis.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Data processing\ntbl_tourism_wide <- tbl_tourism %>%\n  mutate(province_eng = recode(province_eng,\n                       \"Lopburi\" = \"Lop Buri\",\n                       \"Chainat\" = \"Chai Nat\",\n                       \"Chonburi\" = \"Chon Buri\",\n                       \"Prachinburi\" = \"Prachin Buri\",\n                       \"Phang Nga\" = \"Phangnga\",\n                       \"Buriram\" = \"Buri Ram\",\n                       \"Sisaket\" = \"Si Sa Ket\",\n                       \"Nong Bua Lamphu\" = \"Nong Bua Lam Phu\"\n                       ),\n         province_eng = trimws(province_eng)\n         ) %>%\n  pivot_wider(., names_from = \"variable\", values_from = \"value\")\n\n# Check output\nsummary(tbl_tourism_wide)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      date            province_thai      province_eng       region_thai       \n Min.   :2019-01-01   Length:3850        Length:3850        Length:3850       \n 1st Qu.:2020-01-01   Class :character   Class :character   Class :character  \n Median :2021-01-16   Mode  :character   Mode  :character   Mode  :character  \n Mean   :2021-01-15                                                           \n 3rd Qu.:2022-02-01                                                           \n Max.   :2023-02-01                                                           \n  region_eng        ratio_tourist_stay no_tourist_stay   no_tourist_all   \n Length:3850        Min.   : 0.00      Min.   :      0   Min.   :      0  \n Class :character   1st Qu.:20.18      1st Qu.:  16271   1st Qu.:  39092  \n Mode  :character   Median :41.81      Median :  44579   Median :  92122  \n                    Mean   :38.93      Mean   : 105161   Mean   : 206328  \n                    3rd Qu.:56.20      3rd Qu.:  90902   3rd Qu.: 203646  \n                    Max.   :95.86      Max.   :3335728   Max.   :6131044  \n no_tourist_thai   no_tourist_foreign   revenue_all         revenue_thai      \n Min.   :      0   Min.   :      0.0   Min.   :0.000e+00   Min.   :0.000e+00  \n 1st Qu.:  37169   1st Qu.:     49.2   1st Qu.:6.332e+07   1st Qu.:5.925e+07  \n Median :  88782   Median :    553.0   Median :1.955e+08   Median :1.773e+08  \n Mean   : 173962   Mean   :  32366.1   Mean   :1.344e+09   Mean   :6.636e+08  \n 3rd Qu.: 184256   3rd Qu.:   5189.5   3rd Qu.:5.060e+08   3rd Qu.:4.600e+08  \n Max.   :4087756   Max.   :2473725.0   Max.   :1.103e+11   Max.   :4.506e+10  \n revenue_foreign     \n Min.   :-4.250e+03  \n 1st Qu.: 1.100e+05  \n Median : 1.540e+06  \n Mean   : 6.802e+08  \n 3rd Qu.: 1.742e+07  \n Max.   : 8.503e+10  \n```\n\n\n:::\n:::\n\n\n\nThere are some weird values in revenue_foreign (negative), more investigation is required. Furthermore, it was picked up for some rows no_tourist_stay is greater than no_tourist_all, which should not be possible.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntbl_tourism_wide %>%\n  filter(revenue_foreign < 0 | no_tourist_stay > no_tourist_all)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 8 × 13\n  date       province_thai province_eng  region_thai region_eng\n  <date>     <chr>         <chr>         <chr>       <chr>     \n1 2020-03-01 ตราด          Trat          ภาคตะวันออก  east      \n2 2020-05-01 เชียงใหม่       Chiang Mai    ภาคเหนือ     north     \n3 2020-06-01 ชลบุรี          Chon Buri     ภาคตะวันออก  east      \n4 2021-07-01 นครปฐม        Nakhon Pathom ภาคกลาง     central   \n5 2020-08-01 ยะลา          Yala          ภาคใต้       south     \n6 2021-08-01 นครปฐม        Nakhon Pathom ภาคกลาง     central   \n7 2021-08-01 จันทบุรี         Chanthaburi   ภาคตะวันออก  east      \n8 2020-12-01 สมุทรสาคร      Samut Sakhon  ภาคกลาง     central   \n# ℹ 8 more variables: ratio_tourist_stay <dbl>, no_tourist_stay <dbl>,\n#   no_tourist_all <dbl>, no_tourist_thai <dbl>, no_tourist_foreign <dbl>,\n#   revenue_all <dbl>, revenue_thai <dbl>, revenue_foreign <dbl>\n```\n\n\n:::\n:::\n\n\n\nSince this anomaly only pertains to a few rows of data, I'll assume data entry error and re-code those revenue_foreign anomalies to 0 and cap the no_tourist_stay to no_tourist_all.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntbl_tourism_wide <- tbl_tourism_wide %>%\n  mutate(revenue_foreign = if_else(revenue_foreign < 0, 0, revenue_foreign),\n         no_tourist_stay = if_else(no_tourist_stay > no_tourist_all, no_tourist_all, no_tourist_stay))\n\n# Check output\nsummary(tbl_tourism_wide)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      date            province_thai      province_eng       region_thai       \n Min.   :2019-01-01   Length:3850        Length:3850        Length:3850       \n 1st Qu.:2020-01-01   Class :character   Class :character   Class :character  \n Median :2021-01-16   Mode  :character   Mode  :character   Mode  :character  \n Mean   :2021-01-15                                                           \n 3rd Qu.:2022-02-01                                                           \n Max.   :2023-02-01                                                           \n  region_eng        ratio_tourist_stay no_tourist_stay   no_tourist_all   \n Length:3850        Min.   : 0.00      Min.   :      0   Min.   :      0  \n Class :character   1st Qu.:20.18      1st Qu.:  16259   1st Qu.:  39092  \n Mode  :character   Median :41.81      Median :  44579   Median :  92122  \n                    Mean   :38.93      Mean   : 105134   Mean   : 206328  \n                    3rd Qu.:56.20      3rd Qu.:  90902   3rd Qu.: 203646  \n                    Max.   :95.86      Max.   :3335728   Max.   :6131044  \n no_tourist_thai   no_tourist_foreign   revenue_all         revenue_thai      \n Min.   :      0   Min.   :      0.0   Min.   :0.000e+00   Min.   :0.000e+00  \n 1st Qu.:  37169   1st Qu.:     49.2   1st Qu.:6.332e+07   1st Qu.:5.925e+07  \n Median :  88782   Median :    553.0   Median :1.955e+08   Median :1.773e+08  \n Mean   : 173962   Mean   :  32366.1   Mean   :1.344e+09   Mean   :6.636e+08  \n 3rd Qu.: 184256   3rd Qu.:   5189.5   3rd Qu.:5.060e+08   3rd Qu.:4.600e+08  \n Max.   :4087756   Max.   :2473725.0   Max.   :1.103e+11   Max.   :4.506e+10  \n revenue_foreign    \n Min.   :0.000e+00  \n 1st Qu.:1.100e+05  \n Median :1.540e+06  \n Mean   :6.802e+08  \n 3rd Qu.:1.742e+07  \n Max.   :8.503e+10  \n```\n\n\n:::\n:::\n\n\n\nTo facilitate spatial autocorrelation across space and space and time, I need the tourism data in different formats. While doing so, additional KPIs will also be calculated. Rationale for those will be further explained while exploring the data.\n\n::: panel-tabset\n# Overall\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Summarize across all years\ntbl_tourism_sum_all <- tbl_tourism_wide %>%\n  group_by(province_eng, province_thai, region_thai, region_eng) %>%\n  summarize(\n    ratio_tourist_stay = mean(ratio_tourist_stay, na.rm = TRUE),\n    no_tourist_stay = sum(no_tourist_stay, na.rm = TRUE),\n    no_tourist_all = sum(no_tourist_all, na.rm = TRUE),\n    no_tourist_thai = sum(no_tourist_thai, na.rm = TRUE),\n    no_tourist_foreign = sum(no_tourist_foreign, na.rm = TRUE),\n    revenue_all = sum(revenue_all, na.rm = TRUE),\n    revenue_thai = sum(revenue_thai, na.rm = TRUE),\n    revenue_foreign = sum(revenue_foreign, na.rm = TRUE)\n  ) %>%\n  ungroup()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`summarise()` has grouped output by 'province_eng', 'province_thai',\n'region_thai'. You can override using the `.groups` argument.\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Compute additional KPIs\ntbl_tourism_sum_all <- tbl_tourism_sum_all %>%\n  mutate(tourist_thai_prop = ifelse(no_tourist_all == 0, 0, no_tourist_thai/no_tourist_all),\n         tourist_foreign_prop = ifelse(no_tourist_all == 0, 0, no_tourist_foreign/no_tourist_all),\n         revenue_thai_prop = ifelse(revenue_all == 0, 0, revenue_thai/revenue_all),\n         revenue_foreign_prop = ifelse(revenue_all == 0, 0, revenue_foreign/revenue_all),\n         revenue_tourist_all = ifelse(no_tourist_all == 0, 0, revenue_all/no_tourist_all),\n         revenue_tourist_thai = ifelse(no_tourist_thai == 0, 0, revenue_thai/no_tourist_thai),\n         revenue_tourist_foreign = ifelse(no_tourist_foreign == 0, 0, revenue_foreign/no_tourist_foreign),\n         revenue_tourist_stay = ifelse(no_tourist_stay == 0, 0, revenue_all/no_tourist_stay),\n         tourist_stay_all = ifelse(no_tourist_all == 0, 0, no_tourist_stay/no_tourist_all))\n\n# Check output\nsummary(tbl_tourism_sum_all)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n province_eng       province_thai      region_thai         region_eng       \n Length:77          Length:77          Length:77          Length:77         \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n ratio_tourist_stay no_tourist_stay    no_tourist_all      no_tourist_thai    \n Min.   :28.25      Min.   :  259406   Min.   :   772281   Min.   :   750474  \n 1st Qu.:35.02      1st Qu.: 1240268   1st Qu.:  3155560   1st Qu.:  2943753  \n Median :38.76      Median : 2520445   Median :  5474592   Median :  4583102  \n Mean   :38.93      Mean   : 5256719   Mean   : 10316425   Mean   :  8698118  \n 3rd Qu.:42.78      3rd Qu.: 4580731   3rd Qu.: 10819668   3rd Qu.:  9615273  \n Max.   :52.22      Max.   :75436842   Max.   :151352500   Max.   :106899866  \n no_tourist_foreign  revenue_all         revenue_thai       revenue_foreign    \n Min.   :    3771   Min.   :8.961e+08   Min.   :8.918e+08   Min.   :4.300e+06  \n 1st Qu.:   37764   1st Qu.:5.416e+09   1st Qu.:4.860e+09   1st Qu.:7.466e+07  \n Median :  127404   Median :1.330e+10   Median :1.179e+10   Median :3.856e+08  \n Mean   : 1618306   Mean   :6.719e+10   Mean   :3.318e+10   Mean   :3.401e+10  \n 3rd Qu.:  653537   3rd Qu.:2.306e+10   3rd Qu.:2.188e+10   3rd Qu.:2.242e+09  \n Max.   :44452634   Max.   :1.847e+12   Max.   :7.407e+11   Max.   :1.106e+12  \n tourist_thai_prop tourist_foreign_prop revenue_thai_prop revenue_foreign_prop\n Min.   :0.3543    Min.   :0.002864     Min.   :0.1194    Min.   :0.003415    \n 1st Qu.:0.9320    1st Qu.:0.011023     1st Qu.:0.8835    1st Qu.:0.013795    \n Median :0.9789    Median :0.021105     Median :0.9648    Median :0.035169    \n Mean   :0.9158    Mean   :0.084222     Mean   :0.8766    Mean   :0.123400    \n 3rd Qu.:0.9890    3rd Qu.:0.068013     3rd Qu.:0.9862    3rd Qu.:0.116452    \n Max.   :0.9971    Max.   :0.645727     Max.   :0.9966    Max.   :0.880606    \n revenue_tourist_all revenue_tourist_thai revenue_tourist_foreign\n Min.   :  907.7     Min.   :  906.8      Min.   : 1068          \n 1st Qu.: 1500.3     1st Qu.: 1499.0      1st Qu.: 2092          \n Median : 1990.7     Median : 1969.7      Median : 2876          \n Mean   : 3454.3     Mean   : 2805.1      Mean   : 5212          \n 3rd Qu.: 3325.0     3rd Qu.: 3085.8      3rd Qu.: 4743          \n Max.   :30610.0     Max.   :13343.8      Max.   :41744          \n revenue_tourist_stay tourist_stay_all\n Min.   : 2394        Min.   :0.0885  \n 1st Qu.: 3843        1st Qu.:0.3102  \n Median : 4672        Median :0.4984  \n Mean   : 6765        Mean   :0.4983  \n 3rd Qu.: 7129        3rd Qu.:0.6360  \n Max.   :34955        Max.   :0.9044  \n```\n\n\n:::\n:::\n\n\n\n# By Year\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Summarize across all years\ntbl_tourism_sum_year <- tbl_tourism_wide %>%\n  mutate(year = year(date)) %>%\n  group_by(year, province_eng, province_thai, region_thai, region_eng) %>%\n  summarize(\n    ratio_tourist_stay = mean(ratio_tourist_stay, na.rm = TRUE),\n    no_tourist_stay = sum(no_tourist_stay, na.rm = TRUE),\n    no_tourist_all = sum(no_tourist_all, na.rm = TRUE),\n    no_tourist_thai = sum(no_tourist_thai, na.rm = TRUE),\n    no_tourist_foreign = sum(no_tourist_foreign, na.rm = TRUE),\n    revenue_all = sum(revenue_all, na.rm = TRUE),\n    revenue_thai = sum(revenue_thai, na.rm = TRUE),\n    revenue_foreign = sum(revenue_foreign, na.rm = TRUE)\n  ) %>%\n  ungroup()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`summarise()` has grouped output by 'year', 'province_eng', 'province_thai',\n'region_thai'. You can override using the `.groups` argument.\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Compute additional KPIs\ntbl_tourism_sum_year <- tbl_tourism_sum_year %>%\n  mutate(tourist_thai_prop = ifelse(no_tourist_all == 0, 0, no_tourist_thai/no_tourist_all),\n         tourist_foreign_prop = ifelse(no_tourist_all == 0, 0, no_tourist_foreign/no_tourist_all),\n         revenue_thai_prop = ifelse(revenue_all == 0, 0, revenue_thai/revenue_all),\n         revenue_foreign_prop = ifelse(revenue_all == 0, 0, revenue_foreign/revenue_all),\n         revenue_tourist_all = ifelse(no_tourist_all == 0, 0, revenue_all/no_tourist_all),\n         revenue_tourist_thai = ifelse(no_tourist_thai == 0, 0, revenue_thai/no_tourist_thai),\n         revenue_tourist_foreign = ifelse(no_tourist_foreign == 0, 0, revenue_foreign/no_tourist_foreign),\n         revenue_tourist_stay = ifelse(no_tourist_stay == 0, 0, revenue_all/no_tourist_stay),\n         tourist_stay_all = ifelse(no_tourist_all == 0, 0, no_tourist_stay/no_tourist_all))\n\n# Check output\nsummary(tbl_tourism_sum_year)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      year      province_eng       province_thai      region_thai       \n Min.   :2019   Length:385         Length:385         Length:385        \n 1st Qu.:2020   Class :character   Class :character   Class :character  \n Median :2021   Mode  :character   Mode  :character   Mode  :character  \n Mean   :2021                                                           \n 3rd Qu.:2022                                                           \n Max.   :2023                                                           \n  region_eng        ratio_tourist_stay no_tourist_stay    no_tourist_all    \n Length:385         Min.   : 5.452     Min.   :   13523   Min.   :   45008  \n Class :character   1st Qu.:25.977     1st Qu.:  176772   1st Qu.:  425219  \n Mode  :character   Median :42.385     Median :  400926   Median :  889499  \n                    Mean   :42.228     Mean   : 1051344   Mean   : 2063285  \n                    3rd Qu.:57.638     3rd Qu.:  933078   3rd Qu.: 2072363  \n                    Max.   :92.170     Max.   :36407624   Max.   :66966562  \n no_tourist_thai    no_tourist_foreign  revenue_all         revenue_thai      \n Min.   :   44180   Min.   :       0   Min.   :4.204e+07   Min.   :4.165e+07  \n 1st Qu.:  387805   1st Qu.:    2221   1st Qu.:7.809e+08   1st Qu.:7.160e+08  \n Median :  852972   Median :   11860   Median :1.873e+09   Median :1.746e+09  \n Mean   : 1739624   Mean   :  323661   Mean   :1.344e+10   Mean   :6.636e+09  \n 3rd Qu.: 1799767   3rd Qu.:   79008   3rd Qu.:5.134e+09   3rd Qu.:4.647e+09  \n Max.   :42073847   Max.   :24892715   Max.   :1.068e+12   Max.   :3.846e+11  \n revenue_foreign     tourist_thai_prop tourist_foreign_prop revenue_thai_prop\n Min.   :0.000e+00   Min.   :0.2104    Min.   :0.000000     Min.   :0.05123  \n 1st Qu.:4.880e+06   1st Qu.:0.9468    1st Qu.:0.004155     1st Qu.:0.92557  \n Median :3.119e+07   Median :0.9875    Median :0.012525     Median :0.98198  \n Mean   :6.802e+09   Mean   :0.9315    Mean   :0.068537     Mean   :0.90492  \n 3rd Qu.:2.702e+08   3rd Qu.:0.9958    3rd Qu.:0.053158     3rd Qu.:0.99451  \n Max.   :6.832e+11   Max.   :1.0000    Max.   :0.789559     Max.   :1.00000  \n revenue_foreign_prop revenue_tourist_all revenue_tourist_thai\n Min.   :0.000000     Min.   :  695.6     Min.   :  695.2     \n 1st Qu.:0.005495     1st Qu.: 1394.0     1st Qu.: 1382.6     \n Median :0.018025     Median : 1983.6     Median : 1937.6     \n Mean   :0.095078     Mean   : 3207.1     Mean   : 2690.1     \n 3rd Qu.:0.074430     3rd Qu.: 3185.7     3rd Qu.: 3113.0     \n Max.   :0.948773     Max.   :36131.4     Max.   :15683.4     \n revenue_tourist_foreign revenue_tourist_stay tourist_stay_all \n Min.   :    0           Min.   : 2030        Min.   :0.05899  \n 1st Qu.: 1931           1st Qu.: 3557        1st Qu.:0.33405  \n Median : 2657           Median : 4743        Median :0.48410  \n Mean   : 4603           Mean   : 6427        Mean   :0.49282  \n 3rd Qu.: 4373           3rd Qu.: 7059        3rd Qu.:0.61740  \n Max.   :58147           Max.   :44768        Max.   :0.95484  \n```\n\n\n:::\n:::\n\n\n\n# By Year & Month\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# No additional processing required\n# Compute additional KPIs\ntbl_tourism_wide <- tbl_tourism_wide %>%\n  mutate(tourist_thai_prop = ifelse(no_tourist_all == 0, 0, no_tourist_thai/no_tourist_all),\n         tourist_foreign_prop = ifelse(no_tourist_all == 0, 0, no_tourist_foreign/no_tourist_all),\n         revenue_thai_prop = ifelse(revenue_all == 0, 0, revenue_thai/revenue_all),\n         revenue_foreign_prop = ifelse(revenue_all == 0, 0, revenue_foreign/revenue_all),\n         revenue_tourist_all = ifelse(no_tourist_all == 0, 0, revenue_all/no_tourist_all),\n         revenue_tourist_thai = ifelse(no_tourist_thai == 0, 0, revenue_thai/no_tourist_thai),\n         revenue_tourist_foreign = ifelse(no_tourist_foreign == 0, 0, revenue_foreign/no_tourist_foreign),\n         revenue_tourist_stay = ifelse(no_tourist_stay == 0, 0, revenue_all/no_tourist_stay),\n         tourist_stay_all = ifelse(no_tourist_all == 0, 0, no_tourist_stay/no_tourist_all))\n\n# Check output\nsummary(tbl_tourism_wide)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      date            province_thai      province_eng       region_thai       \n Min.   :2019-01-01   Length:3850        Length:3850        Length:3850       \n 1st Qu.:2020-01-01   Class :character   Class :character   Class :character  \n Median :2021-01-16   Mode  :character   Mode  :character   Mode  :character  \n Mean   :2021-01-15                                                           \n 3rd Qu.:2022-02-01                                                           \n Max.   :2023-02-01                                                           \n  region_eng        ratio_tourist_stay no_tourist_stay   no_tourist_all   \n Length:3850        Min.   : 0.00      Min.   :      0   Min.   :      0  \n Class :character   1st Qu.:20.18      1st Qu.:  16259   1st Qu.:  39092  \n Mode  :character   Median :41.81      Median :  44579   Median :  92122  \n                    Mean   :38.93      Mean   : 105134   Mean   : 206328  \n                    3rd Qu.:56.20      3rd Qu.:  90902   3rd Qu.: 203646  \n                    Max.   :95.86      Max.   :3335728   Max.   :6131044  \n no_tourist_thai   no_tourist_foreign   revenue_all         revenue_thai      \n Min.   :      0   Min.   :      0.0   Min.   :0.000e+00   Min.   :0.000e+00  \n 1st Qu.:  37169   1st Qu.:     49.2   1st Qu.:6.332e+07   1st Qu.:5.925e+07  \n Median :  88782   Median :    553.0   Median :1.955e+08   Median :1.773e+08  \n Mean   : 173962   Mean   :  32366.1   Mean   :1.344e+09   Mean   :6.636e+08  \n 3rd Qu.: 184256   3rd Qu.:   5189.5   3rd Qu.:5.060e+08   3rd Qu.:4.600e+08  \n Max.   :4087756   Max.   :2473725.0   Max.   :1.103e+11   Max.   :4.506e+10  \n revenue_foreign     tourist_thai_prop tourist_foreign_prop revenue_thai_prop\n Min.   :0.000e+00   Min.   :0.0000    Min.   :0.0000000    Min.   :0.0000   \n 1st Qu.:1.100e+05   1st Qu.:0.9627    1st Qu.:0.0008535    1st Qu.:0.9511   \n Median :1.540e+06   Median :0.9932    Median :0.0066240    Median :0.9911   \n Mean   :6.802e+08   Mean   :0.9297    Mean   :0.0637772    Mean   :0.9090   \n 3rd Qu.:1.742e+07   3rd Qu.:0.9990    3rd Qu.:0.0346323    3rd Qu.:0.9988   \n Max.   :8.503e+10   Max.   :1.0000    Max.   :1.0000000    Max.   :1.0016   \n revenue_foreign_prop revenue_tourist_all revenue_tourist_thai\n Min.   :0.000000     Min.   :     0      Min.   :    0       \n 1st Qu.:0.001126     1st Qu.:  1366      1st Qu.: 1345       \n Median :0.008700     Median :  1932      Median : 1880       \n Mean   :0.084802     Mean   :  3513      Mean   : 2614       \n 3rd Qu.:0.045997     3rd Qu.:  3199      3rd Qu.: 3082       \n Max.   :1.000000     Max.   :300000      Max.   :17325       \n revenue_tourist_foreign revenue_tourist_stay tourist_stay_all\n Min.   :    0           Min.   :     0       Min.   :0.0000  \n 1st Qu.: 1294           1st Qu.:  3187       1st Qu.:0.3543  \n Median : 2372           Median :  4448       Median :0.5128  \n Mean   : 4504           Mean   :  6428       Mean   :0.5270  \n 3rd Qu.: 4137           3rd Qu.:  6754       3rd Qu.:0.6981  \n Max.   :65000           Max.   :300000       Max.   :1.0000  \n```\n\n\n:::\n:::\n\n\n:::\n\n### 1.2.3 Merge Tourism data\n\nFinally, I can merge the tourism dataset to the spatial dataset using `left_join` from dplyr. These are sorted to facilitate filtering later.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Join with tourism data all\nth_bound_tour_all <- left_join(th_bound_l1, tbl_tourism_sum_all, by = c(\"ADM1_EN\" = \"province_eng\")) %>%\n  arrange(ADM1_EN)\n\n# Join with tourism data by year\nth_bound_tour_year <- left_join(th_bound_l1, tbl_tourism_sum_year, by = c(\"ADM1_EN\" = \"province_eng\")) %>%\n  arrange(year, ADM1_EN)\n\n\n# Join with tourism data by year and month\nth_bound_tour_year_month <- left_join(th_bound_l1, tbl_tourism_wide, by = c(\"ADM1_EN\" = \"province_eng\")) %>%\n  arrange(date.y, ADM1_EN)\n```\n:::\n\n\n\nA good practise is to save these processed datasets for easy retrieval.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Export to processed sub-folder as RDS\nwrite_rds(th_bound_tour_all, 'data/processed/th_bound_tour_all.rds')\n\nwrite_rds(th_bound_tour_year, 'data/processed/th_bound_tour_year.rds')\n\nwrite_rds(th_bound_tour_year_month, 'data/processed/th_bound_tour_year_month.rds')\n```\n:::\n\n\n\nAfter clearing the r environment, I'll load in the various datasets.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Clear R console\nrm(list = ls(all.names = TRUE))\n\n# Load various processed dataset\nth_bound_tour_all <- read_rds('data/processed/th_bound_tour_all.rds')\nth_bound_tour_year <- read_rds('data/processed/th_bound_tour_year.rds')\nth_bound_tour_year_month <- read_rds('data/processed/th_bound_tour_year_month.rds')\n```\n:::\n\n\n\n# 2 Exploratory Data Analysis\n\nIn this section, I will explore the various tourism indicators provided by the dataset.\n\n| Variable           | Definition                                                        |\n|-----------------------|-------------------------------------------------|\n| revenue_all        | Revenue generated by all tourists in the province (Thai Baht)     |\n| revenue_thai       | Revenue generated by Thai tourists in the province (Thai Baht)    |\n| revenue_foreign    | Revenue generated by Foreign tourists in the province (Thai Baht) |\n| no_tourist_all     | Total number of tourists who visited the province                 |\n| no_tourist_thai    | Number of Thai tourists who visited the province                  |\n| no_tourist_foreign | Number of Foreign tourists who visited the province               |\n| ratio_tourist_stay | Occupancy rate - Percentage of occupied travel accomodation       |\n| no_tourist_stay    | Number of Tourists who stayed overnight in the province           |\n\nLets first check the revenue indicators.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Visualize for revenue\nrevenue_all <- ggplot(data=th_bound_tour_all, \n                      aes(x=`revenue_all`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\") + \n  labs(x = \"Revenue from all tourists\")\n\nrevenue_thai <- ggplot(data=th_bound_tour_all, \n                      aes(x=`revenue_thai`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\") + \n  labs(x = \"Revenue from Thai tourists\")\n\nrevenue_foreign <- ggplot(data=th_bound_tour_all, \n                      aes(x=`revenue_foreign`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\") + \n  labs(x = \"Revenue from Foreign tourists\")\n\nggarrange(revenue_all, revenue_thai, revenue_foreign, ncol = 3)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n\nAs expected, there is a large left skew, with majority of provinces generating much lesser revenue as compared to the outliers. Lets look at the tourist count then.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Visualize for tourist\ntourist_all <- ggplot(data=th_bound_tour_all, \n                      aes(x=`no_tourist_all`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\") + \n  labs(x = \"Total Number of tourists\")\n\ntourist_thai <- ggplot(data=th_bound_tour_all, \n                      aes(x=`no_tourist_thai`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\") + \n  labs(x = \"Number of Thai tourists\")\n\ntourist_foreign <- ggplot(data=th_bound_tour_all, \n                      aes(x=`no_tourist_foreign`)) +\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\") + \n  labs(x = \"Number of Foreign tourists\")\n\nggarrange(tourist_all, tourist_thai, tourist_foreign, ncol = 3)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n\nAgain, we see the same distribution for tourist count as compared to revenue. This is can be clearly illustrated when we plot both revenue and tourists as choropleth maps.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntourist.map <- tm_shape(th_bound_tour_all) + \n  tm_fill(col = \"no_tourist_all\",\n          n = 5,\n          style = \"jenks\", \n          title = \"Total Tourist\") + \n  tm_borders(alpha = 0.5) \n\nrevenue.map <- tm_shape(th_bound_tour_all) + \n  tm_fill(col = \"revenue_all\",\n          n = 5,\n          style = \"jenks\",\n          title = \"Total Revenue\") + \n  tm_borders(alpha = 0.5) \n\ntmap_arrange(tourist.map, revenue.map,\n             asp=NA, ncol=2)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_files/figure-html/unnamed-chunk-18-1.png){width=1152}\n:::\n:::\n\n\n\nIt is clear that provinces with larger volume of tourists will generate larger revenue. However, that is not necessarily a good indicator of the tourism economy. Other than just trying to increase revenue by increasing the tourist traffic, the Thai government will also be keen into other indicators.\n\n## 2.1 Feature Engineering\n\nOther variables are created in order to provide greater depth to analysing the Thai tourism economy.\n\n| Variable                | Definition                                          |\n|-------------------------|-----------------------------------------------|\n| tourist_thai_prop       | Proportion of tourists who are Thai                 |\n| tourist_foreign_prop    | Proportion of tourists who are Foreign              |\n| revenue_thai_prop       | Proportion of revenue generated by Thai tourists    |\n| revenue_foreign_prop    | Proportion of revenue generated by Foreign tourists |\n| revenue_tourist_all     | Revenue generated per tourist                       |\n| revenue_tourist_thai    | Revenue generated per Thai tourist                  |\n| revenue_tourist_foreign | Revenue generated per Foreign tourist               |\n| revenue_tourist_stay    | Revenue generated per tourist who stay overnight    |\n| tourist_stay_all        | Proportion of tourists who stayed overnight         |\n\nHere's a quick check for 1 of the\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Visualize revenue per tourist\ntm_shape(th_bound_tour_all) + \n  tm_fill(col = \"revenue_tourist_all\",\n          n = 5,\n          style = \"jenks\", \n          title = \"Revenue per Tourist\") + \n  tm_borders(alpha = 0.5) \n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_files/figure-html/unnamed-chunk-19-1.png){width=1152}\n:::\n:::\n\n\n\nThis clearly shows a different distribution compared to the basic revenue/tourist count distribution. This indicator is also important the Thai government can try to increase total tourism revenue by increasing per Thai Baht spent by each tourist.\n\n## 2.2 Power BI Visualization\n\n::: {style=\"position: relative; width: 100%; height: 0; padding-bottom: 56.25%;\"}\n<iframe title=\"Geospatial TakeHome Ex01\" src=\"https://app.powerbi.com/view?r=eyJrIjoiYzQ3MTQzY2ItNjMyZi00ZWIwLTliYTUtOGQwM2JhNWM3OTVhIiwidCI6ImRmNGU4MzA3LWRjNjQtNDcyYS1iNGI1LWE2ZGQ2YmExMTU2NiIsImMiOjEwfQ%3D%3D\" frameborder=\"0\" allowFullScreen=\"true\" style=\"position: absolute; top: 0; left: 0; width: 100%; height: 100%;\">\n\n</iframe>\n:::\n\nasdlajksldjasklj\n\n# 3 Global Spatial Autocorrelation Analysis of Thailand Tourism Key Indicators\n\nIn order to determine whether tourism indicators are independent of space, and space and time, I would need to do the following:\n\n1.  Compute Spatial Weights\n    a.  Get list of neighbours\n    b.  Calculate weights\n2.  Perform Global Moran's I on key indicators\n\n## 3.1 Spatial Weights Matrix\n\nThere are a few options to get the list of neighbours in `sfdep` package:\n\n| Method                          | Details                                                                      |\n|-------------------------|-----------------------------------------------|\n| `st_contiguity` (i.e. Queen)    | Based on regions with contiguous boundaries (uses `spdep::poly2nb`)          |\n| `st_dist_band` (fixed distance) | Based on distance band (uses `spdep::dnearneigh`)                            |\n| `st_knn` (adaptive distance)    | Based on k nearest neighbours (uses `spdep::knearneigh` and `spdep::knn2nb`) |\n\nBefore passing the coordinates to either functions, checks are required to ensure that the points are in the interior of each province (i.e. not in the middle of the ocean).\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Generate coordinates using st_centroid\nlongitude_cent <- map_dbl(th_bound_tour_all$geometry, ~st_centroid(.x)[[1]])\nlatitude_cent <- map_dbl(th_bound_tour_all$geometry, ~st_centroid(.x)[[2]])\ncoords_cent <- cbind(longitude_cent, latitude_cent)\n\n# Generate coordinates using st_point_on_surface\nlongitude <- map_dbl(th_bound_tour_all$geometry, ~st_point_on_surface(.x)[[1]])\nlatitude <- map_dbl(th_bound_tour_all$geometry, ~st_point_on_surface(.x)[[2]])\ncoords <- cbind(longitude, latitude)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Visualise both points on a map to verify\nplot(th_bound_tour_all$geometry, border=\"lightgrey\", main = \"Points Comparison\")\npoints(coords_cent, pch = 19, cex = 0.2, col = \"red\")\npoints(coords, pch = 19, cex = 0.2, col = \"blue\")\nlegend(\"topright\", legend = c(\"st_centroid\", \"st_point_on_surface-\"), \n       col = c(\"red\", \"blue\"), pch = 19, cex = 0.8)\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_files/figure-html/unnamed-chunk-21-1.png){width=1152}\n:::\n:::\n\n\n\nAfter closely viewing the plot, all points from `st_centroid` are within the interior of the province polygons. With the exception of a few provinces, the points from `st_centroid` are seemingly better placed towards the center as compared to `st_point_on_surface`. Therefore, this allows the sfdep distance based neighbour functions to be used with ease considering st_centroid is used as the default.\n\n::: panel-tabset\n# st_contiguity\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate neighbours\nnb_contiguity <- st_contiguity(th_bound_tour_all$geometry)\n\n# Check output\nnb_contiguity\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNeighbour list object:\nNumber of regions: 77 \nNumber of nonzero links: 352 \nPercentage nonzero weights: 5.93692 \nAverage number of links: 4.571429 \n1 region with no links:\n48\n2 disjoint connected subgraphs\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Visualize neighbours\nplot(th_bound_tour_all$geometry, border=\"lightgrey\", , main=\"Queen Contiguity \")\nplot(nb_contiguity, coords_cent, pch = 19, cex = 0.6, add = TRUE, col = \"red\")\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_files/figure-html/unnamed-chunk-23-1.png){width=1152}\n:::\n:::\n\n\n\n# st_dist_band\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate neighbours\nnb_dist <- st_dist_band(th_bound_tour_all$geometry)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n! Polygon provided. Using point on surface.\n```\n\n\n:::\n\n```{.r .cell-code}\n# Check output\nnb_dist\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNeighbour list object:\nNumber of regions: 77 \nNumber of nonzero links: 474 \nPercentage nonzero weights: 7.994603 \nAverage number of links: 6.155844 \n2 disjoint connected subgraphs\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Visualize neighbours\nplot(th_bound_tour_all$geometry, border=\"lightgrey\", main=\"Distance Band\")\nplot(nb_dist, coords_cent, pch = 19, cex = 0.6, add = TRUE, col = \"red\")\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_files/figure-html/unnamed-chunk-25-1.png){width=1152}\n:::\n:::\n\n\n\n# st_knn\n\nGeneral rule of thumb for k is square root of observations. $$\nk \\approx \\sqrt{76} \\approx 8\n$$ Just for variety, k = 5 (average number from `st_contiguity`) is also run.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate neighbours\nnb_knn_8 <- st_knn(th_bound_tour_all$geometry, k = 8)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n! Polygon provided. Using point on surface.\n```\n\n\n:::\n\n```{.r .cell-code}\nnb_knn_5 <- st_knn(th_bound_tour_all$geometry, k = 5)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n! Polygon provided. Using point on surface.\n```\n\n\n:::\n\n```{.r .cell-code}\n# Check output\nnb_knn_8\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNeighbour list object:\nNumber of regions: 77 \nNumber of nonzero links: 616 \nPercentage nonzero weights: 10.38961 \nAverage number of links: 8 \nNon-symmetric neighbours list\n```\n\n\n:::\n\n```{.r .cell-code}\nnb_knn_5\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNeighbour list object:\nNumber of regions: 77 \nNumber of nonzero links: 385 \nPercentage nonzero weights: 6.493506 \nAverage number of links: 5 \nNon-symmetric neighbours list\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Visualize neighbours\npar(mfrow=c(1,2))\nplot(th_bound_tour_all$geometry, border=\"lightgrey\", main=\"K = 8\")\nplot(nb_knn_8, coords_cent, pch = 19, cex = 0.6, add = TRUE, col = \"red\")\nplot(th_bound_tour_all$geometry, border=\"lightgrey\", main=\"K = 5\")\nplot(nb_knn_5, coords_cent, pch = 19, cex = 0.6, add = TRUE, col = \"red\")\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_files/figure-html/unnamed-chunk-27-1.png){width=1152}\n:::\n:::\n\n\n:::\n\nComparing the various neighbour methods, I have decided on the adaptive method of determining neighbours, specifically k = 5. Reason are as follows:\n\n-   `st_contiguity` - Not appropriate for this case since not all boundaries are contiguous, (i.e. there is an island - Phuket).\n-   `st_dist_band` - Having a fixed distance causes urban provinces to have much more neighbours (i.e. Bangkok Metropolitan Region) while rural provinces have scarce neighbours. I feel that this is not an appropriate relationship for analyzing tourism indicators.\n-   `st_knn` (k = 8) - Judging from the plot, the neighbour list seemed to be much to congested. k = 5 provides a more reasonable structure.\n\nAlthough I have determined the neighbour list, there are also a few options to generate the weights:\n\n| Method                | Details                                          |\n|-----------------------|--------------------------------------------------|\n| `st_weights`          | Standardized weights based on neighbour list     |\n| `st_kernel_weights`   | Weights based on kernel functions and distance   |\n| `st_inverse_distance` | Weights based on inverse distance between points |\n\nGiven the context of tourism, I have decided to explore `st_weights` and `st_inverse_distance`. The rationale for both are as follows:\n\n-   `st_weights` - ensure that all neighbours have equal influence\n-   `st_inverse_distance` - distance is likely a factor especially for specific tourism indicators (i.e. local preferring areas that are closer for a quick getaway, affecting indicators involving overnight stays)\n\nWhile performing `st_weights`, the style is less significant due to the adaptive nature of KNN. W is selected as the default style. Rationale for not choosing the other styles are as follows:\n\n-   B (binary weights) - Does not really matter since neighbours are already treated uniformly\n-   C (globally standardized weights) - Will dilute local effects making it not suitable for tourism analysis\n-   U (equal weights) - Similar to C, less focused on local effects required for tourism analysis\n-   S (variance-stabilizing) - More relevant for analysis where variance stability is important\n-   minmax - Similar to C and U with added layer of normalization\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nth_tour_knn5_all <- th_bound_tour_all %>%\n  mutate(nb = nb_knn_5,\n         wt = st_weights(nb, style = \"W\"),\n         wt_inv = st_inverse_distance(include_self(nb), geometry = geometry, scale = 100, alpha = 1),\n         .before = 1)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n! Polygon provided. Using point on surface.\n```\n\n\n:::\n:::\n\n\n\n## 3.2 Global Moran’s I across Space\n\nIn performing Global Moran's I, `global_moran_perm` will be used over `global_moran` and `global_moran_test` as:\n\n-   `global_moran` does not give any p-value\n-   `global_moran_test` is not as robust as `global_moran_perm` which is a Monte-Carlo simulation.\n\n::: panel-tabset\n# Revenue\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nglobal_moran_perm(th_tour_knn5_all$revenue_all,\n                  th_tour_knn5_all$nb,\n                  th_tour_knn5_all$wt,\n                  nsim = 999)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tMonte-Carlo simulation of Moran I\n\ndata:  x \nweights: listw  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.021003, observed rank = 848, p-value = 0.304\nalternative hypothesis: two.sided\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nglobal_moran_perm(th_tour_knn5_all$revenue_thai,\n                  th_tour_knn5_all$nb,\n                  th_tour_knn5_all$wt,\n                  nsim = 999)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tMonte-Carlo simulation of Moran I\n\ndata:  x \nweights: listw  \nnumber of simulations + 1: 1000 \n\nstatistic = -0.0019269, observed rank = 694, p-value = 0.612\nalternative hypothesis: two.sided\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nglobal_moran_perm(th_tour_knn5_all$revenue_foreign,\n                  th_tour_knn5_all$nb,\n                  th_tour_knn5_all$wt,\n                  nsim = 999)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tMonte-Carlo simulation of Moran I\n\ndata:  x \nweights: listw  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.035698, observed rank = 897, p-value = 0.206\nalternative hypothesis: two.sided\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nglobal_moran_perm(th_tour_knn5_all$revenue_thai_prop,\n                  th_tour_knn5_all$nb,\n                  th_tour_knn5_all$wt,\n                  nsim = 999)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tMonte-Carlo simulation of Moran I\n\ndata:  x \nweights: listw  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.36446, observed rank = 1000, p-value < 2.2e-16\nalternative hypothesis: two.sided\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nglobal_moran_perm(th_tour_knn5_all$revenue_foreign_prop,\n                  th_tour_knn5_all$nb,\n                  th_tour_knn5_all$wt,\n                  nsim = 999)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tMonte-Carlo simulation of Moran I\n\ndata:  x \nweights: listw  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.36446, observed rank = 1000, p-value < 2.2e-16\nalternative hypothesis: two.sided\n```\n\n\n:::\n:::\n\n\n\n# Tourist\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nglobal_moran_perm(th_tour_knn5_all$no_tourist_all,\n                  th_tour_knn5_all$nb,\n                  th_tour_knn5_all$wt,\n                  nsim = 999)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tMonte-Carlo simulation of Moran I\n\ndata:  x \nweights: listw  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.025892, observed rank = 848, p-value = 0.304\nalternative hypothesis: two.sided\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nglobal_moran_perm(th_tour_knn5_all$no_tourist_thai,\n                  th_tour_knn5_all$nb,\n                  th_tour_knn5_all$wt,\n                  nsim = 999)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tMonte-Carlo simulation of Moran I\n\ndata:  x \nweights: listw  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.029083, observed rank = 829, p-value = 0.342\nalternative hypothesis: two.sided\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nglobal_moran_perm(th_tour_knn5_all$no_tourist_foreign,\n                  th_tour_knn5_all$nb,\n                  th_tour_knn5_all$wt,\n                  nsim = 999)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tMonte-Carlo simulation of Moran I\n\ndata:  x \nweights: listw  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.059863, observed rank = 926, p-value = 0.148\nalternative hypothesis: two.sided\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nglobal_moran_perm(th_tour_knn5_all$tourist_thai_prop,\n                  th_tour_knn5_all$nb,\n                  th_tour_knn5_all$wt,\n                  nsim = 999)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tMonte-Carlo simulation of Moran I\n\ndata:  x \nweights: listw  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.39259, observed rank = 1000, p-value < 2.2e-16\nalternative hypothesis: two.sided\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nglobal_moran_perm(th_tour_knn5_all$tourist_foreign_prop,\n                  th_tour_knn5_all$nb,\n                  th_tour_knn5_all$wt,\n                  nsim = 999)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tMonte-Carlo simulation of Moran I\n\ndata:  x \nweights: listw  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.39259, observed rank = 1000, p-value < 2.2e-16\nalternative hypothesis: two.sided\n```\n\n\n:::\n:::\n\n\n\n# Revenue/Tourist\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nglobal_moran_perm(th_tour_knn5_all$revenue_tourist_all,\n                  th_tour_knn5_all$nb,\n                  th_tour_knn5_all$wt,\n                  nsim = 999)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tMonte-Carlo simulation of Moran I\n\ndata:  x \nweights: listw  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.35986, observed rank = 1000, p-value < 2.2e-16\nalternative hypothesis: two.sided\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nglobal_moran_perm(th_tour_knn5_all$revenue_tourist_thai,\n                  th_tour_knn5_all$nb,\n                  th_tour_knn5_all$wt,\n                  nsim = 999)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tMonte-Carlo simulation of Moran I\n\ndata:  x \nweights: listw  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.38688, observed rank = 1000, p-value < 2.2e-16\nalternative hypothesis: two.sided\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nglobal_moran_perm(th_tour_knn5_all$revenue_tourist_foreign,\n                  th_tour_knn5_all$nb,\n                  th_tour_knn5_all$wt,\n                  nsim = 999)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tMonte-Carlo simulation of Moran I\n\ndata:  x \nweights: listw  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.2972, observed rank = 1000, p-value < 2.2e-16\nalternative hypothesis: two.sided\n```\n\n\n:::\n:::\n\n\n\n# Occupancy Rate\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nglobal_moran_perm(th_tour_knn5_all$ratio_tourist_stay,\n                  th_tour_knn5_all$nb,\n                  th_tour_knn5_all$wt,\n                  nsim = 999)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tMonte-Carlo simulation of Moran I\n\ndata:  x \nweights: listw  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.087707, observed rank = 931, p-value = 0.138\nalternative hypothesis: two.sided\n```\n\n\n:::\n:::\n\n\n\n# Overnight Guest\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nglobal_moran_perm(th_tour_knn5_all$no_tourist_stay,\n                  th_tour_knn5_all$nb,\n                  th_tour_knn5_all$wt,\n                  nsim = 999)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tMonte-Carlo simulation of Moran I\n\ndata:  x \nweights: listw  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.027289, observed rank = 828, p-value = 0.344\nalternative hypothesis: two.sided\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nglobal_moran_perm(th_tour_knn5_all$tourist_stay_all,\n                  th_tour_knn5_all$nb,\n                  th_tour_knn5_all$wt,\n                  nsim = 999)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tMonte-Carlo simulation of Moran I\n\ndata:  x \nweights: listw  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.35405, observed rank = 1000, p-value < 2.2e-16\nalternative hypothesis: two.sided\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nglobal_moran_perm(th_tour_knn5_all$revenue_tourist_stay,\n                  th_tour_knn5_all$nb,\n                  th_tour_knn5_all$wt,\n                  nsim = 999)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tMonte-Carlo simulation of Moran I\n\ndata:  x \nweights: listw  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.35298, observed rank = 1000, p-value < 2.2e-16\nalternative hypothesis: two.sided\n```\n\n\n:::\n:::\n\n\n:::\n\nasdjklasjdklasjd\n\n## 3.3 Global Moran's I across Space and Time\n\nTo determine whether the tourism indicators are independent of space and time, I will do the following:\n\n1.  Filter the respective datasets by specific time (Year/Year and month)\n2.  Append the neighbour list created in 3.1\n3.  Calculate the spatial weight matrix\n4.  Perform Global Moran's I for all KPIs\n5.  Consolidate the results of the Global Moran's I\n\nSince this is very repetitive, I'll use a function to run this iteratively.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Function to run global_moran_perm iteratively\nrun_global_moran <- function(data, date_col, value, kpi_weight, kpi_inv_dist) {\n  # Filter sf dataframe\n  filtered_data <- data %>%\n    filter(!!sym(date_col) == value)\n  \n  # Append neighbour list and calculate spatial weight matrix\n  filtered_data <- filtered_data %>%\n    mutate(nb = nb_knn_5,\n           wt = st_weights(nb, style = \"W\"),\n           wt_inv = st_inverse_distance(include_self(nb), geometry = geometry, scale = 100, alpha = 1),\n           .before = 1)\n  \n  # Run global_moran_perm for each KPI in kpi_weight list\n  results_wt <- lapply(kpi_weight, function(kpi) {\n    moran_output <- global_moran_perm(filtered_data[[kpi]],\n                                      filtered_data$nb,\n                                      filtered_data$wt,\n                                      nsim = 999)\n    data.frame(\n      kpi = kpi,\n      statistic = moran_output$statistic,\n      p_value = moran_output$p.value\n      )\n  })\n  \n  # Run global_moran_perm for each KPI in kpi_inv_dist list\n  results_inv_dist <- lapply(kpi_inv_dist, function(kpi) {\n    moran_output <- global_moran_perm(filtered_data[[kpi]],\n                                      filtered_data$nb,\n                                      filtered_data$wt_inv,\n                                      nsim = 999)\n    data.frame(\n      kpi = kpi,\n      statistic = moran_output$statistic,\n      p_value = moran_output$p.value\n      )\n  })\n  \n  # Combine both results\n  results_df <- bind_rows(results_wt, results_inv_dist)\n  \n  results_df <- results_df %>%\n    mutate(date = value,\n           .before = 1)\n  rownames(results_df) <- NULL\n  return(results_df)\n}\n```\n:::\n\n\n\n### 3.3.1 Across Year\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Set Seed\nset.seed(42)\n\n\n# List of KPIs using st_weights\nkpi_wt <- c(\n  \"revenue_all\", \"revenue_thai\", \"revenue_foreign\", \"revenue_thai_prop\", \"revenue_foreign_prop\",\n  \"no_tourist_all\", \"no_tourist_thai\", \"no_tourist_foreign\", \"tourist_thai_prop\", \"tourist_foreign_prop\",\n  \"revenue_tourist_all\", \"revenue_tourist_thai\", \"revenue_tourist_foreign\", \n  \"ratio_tourist_stay\" \n)\n\n# List of KPIs using st_inverse_distance\nkpi_dist <- c(\"no_tourist_stay\", \"revenue_tourist_stay\", \"tourist_stay_all\")\n\n\nyear_list <- unique(th_bound_tour_year$year)\n\nall_results <- list()\n\nfor (year_val in year_list) {\n  # Run function for each year\n  result <- run_global_moran(th_bound_tour_year, \"year\", year_val, kpi_wt, kpi_dist)\n  \n  # Append results to list\n  all_results[[as.character(year_val)]] <- result\n}\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n```\n\n\n:::\n\n```{.r .cell-code}\nglobal_moran_year <- bind_rows(all_results)\n\n#\nglobal_moran_year <- global_moran_year %>%\n  mutate(statistic = ifelse(p_value <= 0.05, round(statistic,3), \"-\")) %>%\n  select(date, kpi, statistic) %>%\n  pivot_wider(names_from = date, values_from = statistic)\n```\n:::\n\n\n\nNow that the data is properly formatted,\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndatatable(global_moran_year, rownames=FALSE, extensions=\"Scroller\", class=\"display\", width=\"100%\",\n            options=list(initComplete = JS(\n    \"function(settings, json) {\",\n    \"$('body').css({'font-family': 'sans-serif'});\",\n    \"}\"\n  ), deferRender=TRUE, scrollY=300, scroller=TRUE))\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"htmlwidget-fd6fe5fb5edf7e94aa22\" style=\"width:100%;height:auto;\" class=\"datatables html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-fd6fe5fb5edf7e94aa22\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"extensions\":[\"Scroller\"],\"data\":[[\"revenue_all\",\"revenue_thai\",\"revenue_foreign\",\"revenue_thai_prop\",\"revenue_foreign_prop\",\"no_tourist_all\",\"no_tourist_thai\",\"no_tourist_foreign\",\"tourist_thai_prop\",\"tourist_foreign_prop\",\"revenue_tourist_all\",\"revenue_tourist_thai\",\"revenue_tourist_foreign\",\"ratio_tourist_stay\",\"no_tourist_stay\",\"revenue_tourist_stay\",\"tourist_stay_all\"],[\"-\",\"-\",\"-\",\"0.331\",\"0.331\",\"-\",\"-\",\"-\",\"0.342\",\"0.342\",\"0.385\",\"0.389\",\"0.31\",\"0.173\",\"-\",\"0.201\",\"0.354\"],[\"-\",\"-\",\"-\",\"0.415\",\"0.415\",\"-\",\"-\",\"-\",\"0.42\",\"0.42\",\"0.443\",\"0.406\",\"0.376\",\"0.294\",\"-\",\"0.261\",\"0.392\"],[\"-\",\"-\",\"-\",\"0.148\",\"0.148\",\"-\",\"-\",\"-\",\"0.223\",\"0.223\",\"0.362\",\"0.425\",\"0.129\",\"0.279\",\"-0.11\",\"0.132\",\"0.503\"],[\"-\",\"-\",\"-\",\"0.217\",\"0.217\",\"-\",\"-\",\"-\",\"0.283\",\"0.283\",\"0.193\",\"0.351\",\"0.102\",\"0.171\",\"-\",\"-\",\"0.436\"],[\"-\",\"-\",\"-\",\"0.217\",\"0.217\",\"-\",\"-\",\"-\",\"0.296\",\"0.296\",\"0.141\",\"0.3\",\"-\",\"0.191\",\"-\",\"-\",\"0.369\"]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th>kpi<\\/th>\\n      <th>2019<\\/th>\\n      <th>2020<\\/th>\\n      <th>2021<\\/th>\\n      <th>2022<\\/th>\\n      <th>2023<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"initComplete\":\"function(settings, json) {\\n$('body').css({'font-family': 'sans-serif'});\\n}\",\"deferRender\":true,\"scrollY\":300,\"scroller\":true,\"columnDefs\":[{\"name\":\"kpi\",\"targets\":0},{\"name\":\"2019\",\"targets\":1},{\"name\":\"2020\",\"targets\":2},{\"name\":\"2021\",\"targets\":3},{\"name\":\"2022\",\"targets\":4},{\"name\":\"2023\",\"targets\":5}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[\"options.initComplete\"],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n### 3.3.2 Across Year and Month\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nyear_month_list <- unique(th_bound_tour_year_month$date.y)\n\nall_results <- list()\n\nfor (year_month_val in year_month_list) {\n  # Run function for each year\n  result <- run_global_moran(th_bound_tour_year_month, \"date.y\", year_month_val, kpi_wt, kpi_dist)\n  \n  # Append results to list\n  all_results[[as.character(year_month_val)]] <- result\n}\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n! Polygon provided. Using point on surface.\n```\n\n\n:::\n\n```{.r .cell-code}\nglobal_moran_year_month <- bind_rows(all_results)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nglobal_moran_year_month <- global_moran_year_month %>%\n  mutate(date = as.Date.numeric(date),\n         year = year(date),\n         month = format(date,\"%b\"),\n         statistic = ifelse(p_value <= 0.05, round(statistic,3), \"-\")) %>%\n  select(year, kpi, statistic, month) %>%\n  pivot_wider(names_from = month, values_from = statistic)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nshared <- SharedData$new(global_moran_year_month)\n\nfilter_select(\n  id = \"year\", label = \"year\", \n  sharedData = shared, ~year\n)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"year\" class=\"form-group crosstalk-input-select crosstalk-input\">\n<label class=\"control-label\" for=\"year\">year</label>\n<div>\n<select multiple></select>\n<script type=\"application/json\" data-for=\"year\">{\n  \"items\": {\n    \"value\": [\"2019\", \"2020\", \"2021\", \"2022\", \"2023\"],\n    \"label\": [\"2019\", \"2020\", \"2021\", \"2022\", \"2023\"]\n  },\n  \"map\": {\n    \"2019\": [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\", \"13\", \"14\", \"15\", \"16\", \"17\"],\n    \"2020\": [\"18\", \"19\", \"20\", \"21\", \"22\", \"23\", \"24\", \"25\", \"26\", \"27\", \"28\", \"29\", \"30\", \"31\", \"32\", \"33\", \"34\"],\n    \"2021\": [\"35\", \"36\", \"37\", \"38\", \"39\", \"40\", \"41\", \"42\", \"43\", \"44\", \"45\", \"46\", \"47\", \"48\", \"49\", \"50\", \"51\"],\n    \"2022\": [\"52\", \"53\", \"54\", \"55\", \"56\", \"57\", \"58\", \"59\", \"60\", \"61\", \"62\", \"63\", \"64\", \"65\", \"66\", \"67\", \"68\"],\n    \"2023\": [\"69\", \"70\", \"71\", \"72\", \"73\", \"74\", \"75\", \"76\", \"77\", \"78\", \"79\", \"80\", \"81\", \"82\", \"83\", \"84\", \"85\"]\n  },\n  \"group\": [\"SharedData21229b6b\"]\n}</script>\n</div>\n</div>\n```\n\n:::\n\n```{.r .cell-code}\ndatatable(shared, rownames=FALSE, extensions=\"Scroller\", class=\"display\", width=\"100%\",\n            options=list(initComplete = JS(\n    \"function(settings, json) {\",\n    \"$('body').css({'font-family': 'sans-serif'});\",\n    \"}\"\n  ), deferRender=TRUE, scrollY=300, scroller=TRUE))\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"htmlwidget-7b16e5c229a647d36070\" style=\"width:100%;height:auto;\" class=\"datatables html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-7b16e5c229a647d36070\">{\"x\":{\"crosstalkOptions\":{\"key\":[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\",\"58\",\"59\",\"60\",\"61\",\"62\",\"63\",\"64\",\"65\",\"66\",\"67\",\"68\",\"69\",\"70\",\"71\",\"72\",\"73\",\"74\",\"75\",\"76\",\"77\",\"78\",\"79\",\"80\",\"81\",\"82\",\"83\",\"84\",\"85\"],\"group\":\"SharedData21229b6b\"},\"filter\":\"none\",\"vertical\":false,\"extensions\":[\"Scroller\"],\"data\":[[2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2022,2022,2022,2022,2022,2022,2022,2022,2022,2022,2022,2022,2022,2022,2022,2022,2022,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023,2023],[\"revenue_all\",\"revenue_thai\",\"revenue_foreign\",\"revenue_thai_prop\",\"revenue_foreign_prop\",\"no_tourist_all\",\"no_tourist_thai\",\"no_tourist_foreign\",\"tourist_thai_prop\",\"tourist_foreign_prop\",\"revenue_tourist_all\",\"revenue_tourist_thai\",\"revenue_tourist_foreign\",\"ratio_tourist_stay\",\"no_tourist_stay\",\"revenue_tourist_stay\",\"tourist_stay_all\",\"revenue_all\",\"revenue_thai\",\"revenue_foreign\",\"revenue_thai_prop\",\"revenue_foreign_prop\",\"no_tourist_all\",\"no_tourist_thai\",\"no_tourist_foreign\",\"tourist_thai_prop\",\"tourist_foreign_prop\",\"revenue_tourist_all\",\"revenue_tourist_thai\",\"revenue_tourist_foreign\",\"ratio_tourist_stay\",\"no_tourist_stay\",\"revenue_tourist_stay\",\"tourist_stay_all\",\"revenue_all\",\"revenue_thai\",\"revenue_foreign\",\"revenue_thai_prop\",\"revenue_foreign_prop\",\"no_tourist_all\",\"no_tourist_thai\",\"no_tourist_foreign\",\"tourist_thai_prop\",\"tourist_foreign_prop\",\"revenue_tourist_all\",\"revenue_tourist_thai\",\"revenue_tourist_foreign\",\"ratio_tourist_stay\",\"no_tourist_stay\",\"revenue_tourist_stay\",\"tourist_stay_all\",\"revenue_all\",\"revenue_thai\",\"revenue_foreign\",\"revenue_thai_prop\",\"revenue_foreign_prop\",\"no_tourist_all\",\"no_tourist_thai\",\"no_tourist_foreign\",\"tourist_thai_prop\",\"tourist_foreign_prop\",\"revenue_tourist_all\",\"revenue_tourist_thai\",\"revenue_tourist_foreign\",\"ratio_tourist_stay\",\"no_tourist_stay\",\"revenue_tourist_stay\",\"tourist_stay_all\",\"revenue_all\",\"revenue_thai\",\"revenue_foreign\",\"revenue_thai_prop\",\"revenue_foreign_prop\",\"no_tourist_all\",\"no_tourist_thai\",\"no_tourist_foreign\",\"tourist_thai_prop\",\"tourist_foreign_prop\",\"revenue_tourist_all\",\"revenue_tourist_thai\",\"revenue_tourist_foreign\",\"ratio_tourist_stay\",\"no_tourist_stay\",\"revenue_tourist_stay\",\"tourist_stay_all\"],[\"-\",\"-\",\"-\",\"0.328\",\"0.328\",\"-\",\"-\",\"-\",\"0.331\",\"0.331\",\"0.386\",\"0.383\",\"0.349\",\"-\",\"-\",\"0.25\",\"0.281\",\"-\",\"-\",\"-\",\"0.333\",\"0.333\",\"-\",\"-\",\"-\",\"0.335\",\"0.335\",\"0.401\",\"0.388\",\"0.374\",\"-\",\"-\",\"0.262\",\"0.296\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"0.31\",\"0.315\",\"0.16\",\"0.441\",\"-0.154\",\"-\",\"0.47\",\"-\",\"-\",\"-\",\"0.284\",\"0.284\",\"-\",\"-\",\"0.133\",\"0.399\",\"0.399\",\"0.299\",\"0.405\",\"0.113\",\"0.353\",\"-\",\"0.149\",\"0.486\",\"-\",\"-\",\"-\",\"0.212\",\"0.212\",\"-\",\"-\",\"-\",\"0.285\",\"0.285\",\"0.151\",\"0.301\",\"-\",\"0.19\",\"-\",\"-\",\"0.402\"],[\"-\",\"-\",\"-\",\"0.311\",\"0.311\",\"-\",\"-\",\"0.096\",\"0.306\",\"0.306\",\"0.393\",\"0.383\",\"0.349\",\"0.196\",\"-\",\"0.237\",\"0.28\",\"-\",\"-\",\"-\",\"0.313\",\"0.313\",\"-\",\"-\",\"-\",\"0.305\",\"0.305\",\"0.429\",\"0.395\",\"0.388\",\"-\",\"-\",\"0.246\",\"0.28\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"0.159\",\"0.159\",\"0.376\",\"0.38\",\"0.167\",\"0.345\",\"-0.153\",\"0.142\",\"0.491\",\"-\",\"-\",\"-\",\"0.289\",\"0.289\",\"-\",\"-\",\"-\",\"0.406\",\"0.406\",\"0.299\",\"0.411\",\"0.111\",\"0.352\",\"-\",\"0.161\",\"0.461\",\"-\",\"-\",\"-\",\"0.217\",\"0.217\",\"-\",\"-\",\"-\",\"0.296\",\"0.296\",\"0.134\",\"0.299\",\"-\",\"0.193\",\"-\",\"-\",\"0.343\"],[\"-\",\"-\",\"-\",\"0.316\",\"0.316\",\"-\",\"-\",\"0.115\",\"0.32\",\"0.32\",\"0.399\",\"0.383\",\"0.349\",\"0.371\",\"-\",\"0.244\",\"0.287\",\"-\",\"-\",\"-\",\"0.239\",\"0.239\",\"-\",\"-\",\"-\",\"0.225\",\"0.225\",\"0.416\",\"0.408\",\"0.363\",\"0.203\",\"-\",\"0.168\",\"0.329\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"0.135\",\"0.135\",\"0.359\",\"0.363\",\"0.244\",\"0.22\",\"-0.168\",\"0.203\",\"0.514\",\"-\",\"-\",\"-\",\"0.329\",\"0.329\",\"-\",\"-\",\"-\",\"0.435\",\"0.435\",\"0.296\",\"0.395\",\"0.127\",\"0.264\",\"-\",\"0.147\",\"0.469\",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[\"-\",\"-\",\"-\",\"0.304\",\"0.304\",\"-\",\"-\",\"-\",\"0.334\",\"0.334\",\"0.373\",\"0.43\",\"0.267\",\"0.333\",\"-\",\"0.183\",\"0.317\",\"-\",\"-\",\"-\",\"-\",\"0.242\",\"-\",\"-\",\"-\",\"-\",\"0.26\",\"0.149\",\"0.206\",\"0.436\",\"0.153\",\"-0.051\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"0.2\",\"0.2\",\"0.386\",\"0.391\",\"0.275\",\"0.213\",\"-\",\"0.265\",\"0.437\",\"-\",\"-\",\"-\",\"0.319\",\"0.319\",\"-\",\"-\",\"-\",\"0.428\",\"0.428\",\"0.276\",\"0.372\",\"0.123\",\"0.167\",\"-\",\"0.153\",\"0.454\",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[\"-\",\"-\",\"-\",\"0.307\",\"0.307\",\"-\",\"-\",\"-\",\"0.344\",\"0.344\",\"0.368\",\"0.43\",\"0.267\",\"0.24\",\"-\",\"0.187\",\"0.323\",\"-\",\"-\",\"-\",\"0.459\",\"0.45\",\"-\",\"-\",\"-\",\"0.47\",\"0.515\",\"0.513\",\"0.15\",\"0.347\",\"0.503\",\"-0.062\",\"0.337\",\"0.166\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"0.255\",\"0.255\",\"0.5\",\"0.506\",\"0.187\",\"0.269\",\"-0.106\",\"0.27\",\"0.313\",\"-\",\"-\",\"-\",\"0.252\",\"0.252\",\"-\",\"-\",\"-\",\"0.291\",\"0.291\",\"0.212\",\"0.37\",\"0.114\",\"-\",\"-\",\"0.116\",\"0.426\",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[\"-\",\"-\",\"-\",\"0.312\",\"0.312\",\"-\",\"-\",\"-\",\"0.346\",\"0.346\",\"0.386\",\"0.43\",\"0.267\",\"0.135\",\"-\",\"0.181\",\"0.319\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"0.12\",\"0.449\",\"0.424\",\"-\",\"0.321\",\"-\",\"0.211\",\"0.358\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"0.13\",\"-\",\"0.491\",\"0.496\",\"0.192\",\"0.192\",\"-0.117\",\"0.259\",\"0.273\",\"-\",\"-\",\"-\",\"0.224\",\"0.224\",\"-\",\"-\",\"-\",\"0.26\",\"0.26\",\"0.189\",\"0.359\",\"0.104\",\"-\",\"-\",\"-\",\"0.415\",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[\"-\",\"-\",\"-\",\"0.302\",\"0.302\",\"-\",\"-\",\"-\",\"0.312\",\"0.312\",\"0.407\",\"0.347\",\"0.325\",\"-\",\"-\",\"0.115\",\"0.358\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"0.372\",\"0.369\",\"0.16\",\"0.281\",\"-\",\"-\",\"0.342\",\"-\",\"-\",\"-\",\"0.137\",\"0.137\",\"-\",\"-\",\"-\",\"0.162\",\"0.162\",\"0.233\",\"0.505\",\"0.077\",\"0.358\",\"-0.12\",\"0.144\",\"0.308\",\"-\",\"-\",\"-\",\"0.205\",\"0.205\",\"-\",\"-\",\"-\",\"0.255\",\"0.255\",\"0.159\",\"0.342\",\"-\",\"-\",\"-\",\"-\",\"0.41\",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[\"-\",\"-\",\"-\",\"0.302\",\"0.302\",\"-\",\"-\",\"-\",\"0.299\",\"0.299\",\"0.396\",\"0.347\",\"0.325\",\"0.188\",\"-\",\"0.113\",\"0.356\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"0.378\",\"0.368\",\"0.147\",\"0.328\",\"-\",\"-\",\"0.387\",\"-\",\"-\",\"-\",\"0.202\",\"0.202\",\"-\",\"-\",\"-\",\"0.262\",\"0.262\",\"0.215\",\"0.493\",\"0.112\",\"0.376\",\"-0.112\",\"0.125\",\"0.305\",\"-\",\"-\",\"-\",\"0.198\",\"0.198\",\"-\",\"-\",\"-\",\"0.25\",\"0.25\",\"0.171\",\"0.344\",\"0.108\",\"-\",\"-\",\"-\",\"0.398\",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[\"-\",\"-\",\"-\",\"0.315\",\"0.315\",\"-\",\"-\",\"-\",\"0.319\",\"0.319\",\"0.399\",\"0.347\",\"0.325\",\"0.201\",\"-\",\"-\",\"0.363\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"0.406\",\"0.409\",\"0.129\",\"0.26\",\"-\",\"-\",\"0.379\",\"-\",\"-\",\"-\",\"0.271\",\"0.271\",\"-\",\"-\",\"-\",\"0.372\",\"0.372\",\"0.321\",\"0.494\",\"0.118\",\"0.354\",\"-\",\"0.193\",\"0.402\",\"-\",\"-\",\"-\",\"0.194\",\"0.194\",\"-\",\"-\",\"-\",\"0.248\",\"0.248\",\"0.164\",\"0.332\",\"0.106\",\"-\",\"-\",\"-\",\"0.407\",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[\"-\",\"-\",\"-\",\"0.346\",\"0.346\",\"-\",\"-\",\"-\",\"0.344\",\"0.344\",\"0.346\",\"0.336\",\"0.257\",\"-\",\"-\",\"0.199\",\"0.332\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"-\",\"0.168\",\"0.168\",\"0.375\",\"0.379\",\"0.178\",\"0.324\",\"-\",\"0.158\",\"0.455\",\"-\",\"-\",\"-\",\"0.307\",\"0.307\",\"-\",\"-\",\"-\",\"0.37\",\"0.37\",\"0.337\",\"0.494\",\"0.106\",\"0.397\",\"-\",\"-\",\"0.424\",\"-\",\"-\",\"-\",\"0.192\",\"0.192\",\"-\",\"-\",\"-\",\"0.257\",\"0.257\",\"0.159\",\"0.315\",\"-\",\"-\",\"-\",\"-\",\"0.416\",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[\"-\",\"-\",\"-\",\"0.36\",\"0.36\",\"-\",\"-\",\"-\",\"0.36\",\"0.36\",\"0.356\",\"0.336\",\"0.257\",\"-\",\"-\",\"0.201\",\"0.33\",\"-\",\"-\",\"-\",\"0.136\",\"0.136\",\"-\",\"-\",\"-\",\"0.265\",\"0.265\",\"0.372\",\"0.374\",\"0.224\",\"0.379\",\"-\",\"0.15\",\"0.451\",\"-\",\"-\",\"-\",\"0.248\",\"0.248\",\"-\",\"-\",\"-\",\"0.267\",\"0.267\",\"0.345\",\"0.48\",\"0.116\",\"0.431\",\"-\",\"-\",\"0.499\",\"-\",\"-\",\"-\",\"0.185\",\"0.185\",\"-\",\"-\",\"-\",\"0.249\",\"0.249\",\"0.155\",\"0.307\",\"-\",\"0.166\",\"-\",\"-\",\"0.408\",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[\"-\",\"-\",\"-\",\"0.369\",\"0.369\",\"-\",\"-\",\"-\",\"0.38\",\"0.38\",\"0.36\",\"0.336\",\"0.257\",\"0.158\",\"-\",\"0.191\",\"0.324\",\"-\",\"-\",\"-\",\"0.103\",\"0.103\",\"-\",\"-\",\"-\",\"0.232\",\"0.232\",\"0.361\",\"0.365\",\"0.221\",\"0.362\",\"-\",\"-\",\"0.375\",\"-\",\"-\",\"-\",\"0.193\",\"0.193\",\"-\",\"-\",\"-\",\"0.218\",\"0.218\",\"0.257\",\"0.401\",\"0.124\",\"0.414\",\"-\",\"0.127\",\"0.458\",\"-\",\"-\",\"-\",\"0.207\",\"0.207\",\"-\",\"-\",\"-\",\"0.276\",\"0.276\",\"0.152\",\"0.297\",\"-\",\"0.223\",\"-\",\"-\",\"0.43\",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th>year<\\/th>\\n      <th>kpi<\\/th>\\n      <th>Jan<\\/th>\\n      <th>Feb<\\/th>\\n      <th>Mar<\\/th>\\n      <th>Apr<\\/th>\\n      <th>May<\\/th>\\n      <th>Jun<\\/th>\\n      <th>Jul<\\/th>\\n      <th>Aug<\\/th>\\n      <th>Sep<\\/th>\\n      <th>Oct<\\/th>\\n      <th>Nov<\\/th>\\n      <th>Dec<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"initComplete\":\"function(settings, json) {\\n$('body').css({'font-family': 'sans-serif'});\\n}\",\"deferRender\":true,\"scrollY\":300,\"scroller\":true,\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":0},{\"name\":\"year\",\"targets\":0},{\"name\":\"kpi\",\"targets\":1},{\"name\":\"Jan\",\"targets\":2},{\"name\":\"Feb\",\"targets\":3},{\"name\":\"Mar\",\"targets\":4},{\"name\":\"Apr\",\"targets\":5},{\"name\":\"May\",\"targets\":6},{\"name\":\"Jun\",\"targets\":7},{\"name\":\"Jul\",\"targets\":8},{\"name\":\"Aug\",\"targets\":9},{\"name\":\"Sep\",\"targets\":10},{\"name\":\"Oct\",\"targets\":11},{\"name\":\"Nov\",\"targets\":12},{\"name\":\"Dec\",\"targets\":13}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false},\"selection\":{\"mode\":\"multiple\",\"selected\":null,\"target\":\"row\",\"selectable\":null}},\"evals\":[\"options.initComplete\"],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n# 4 Local Spatial Autocorrelation Analysis of Thailand Tourism Key Indicators\n\nFor this, I will ....\n\n# 5 Spatial-Temporal Analysis of Thailand Tourism Key Indicators\n\n## 5.1 Preprocessing\n\n## 5.2 Mann-Kendall\n\n## 5.3 Emerging Hotspot Analysis\n\n# 6 Conclusion\n",
    "supporting": [
      "Take-Home_Ex02_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<link href=\"../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/datatables-binding-0.33/datatables.js\"></script>\n<script src=\"../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"../../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js\"></script>\n<link href=\"../../site_libs/dt-ext-scroller-1.13.6/css/scroller.dataTables.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/dt-ext-scroller-1.13.6/js/dataTables.scroller.min.js\"></script>\n<link href=\"../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n<link href=\"../../site_libs/selectize-0.12.4/css/selectize.bootstrap3.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/selectize-0.12.4/js/selectize.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}